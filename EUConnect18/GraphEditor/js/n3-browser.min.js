/** @license MIT - N3.js 0.11.2 (browser build) - Â©Ruben Verborgh */
!function(e){!function(){var t="http://www.w3.org/2001/XMLSchema#",i=t+"double",r={isIRI:function(e){if("string"!=typeof e)return!1;if(0===e.length)return!0;var t=e[0];return'"'!==t&&"_"!==t},isLiteral:function(e){return"string"==typeof e&&'"'===e[0]},isBlank:function(e){return"string"==typeof e&&"_:"===e.substr(0,2)},isDefaultGraph:function(e){return!e},inDefaultGraph:function(e){return!e.graph},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return"string"==typeof e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var i,r,s,n=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return n&&(i=n[1],r=t[i],s=n.index),void 0===r?e:0===s?r+e.substr(i.length+1):e.substr(0,s+3)+r+e.substr(s+i.length+4)},createIRI:function(e){return e&&'"'===e[0]?r.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t="http://www.w3.org/2001/XMLSchema#boolean";break;case"number":isFinite(e)?t=e%1==0?"http://www.w3.org/2001/XMLSchema#integer":i:(t=i,isNaN(e)||(e=e>0?"INF":"-INF"));break;default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)},prefix:function(e){return r.prefixes({"":e})("")},prefixes:function(e){function t(e,t){if(t||!(e in i)){var r=Object.create(null);t=t||"",i[e]=function(e){return r[e]||(r[e]=t+e)}}return i[e]}var i=Object.create(null);for(var r in e)t(r,e[r]);return t}};e.Util=r}(),function(){function t(e){if(!(this instanceof t))return new t(e);if((e=e||{}).lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var i=this;this._tokenize=this.tokenize,this.tokenize=function(e,t){this._tokenize(e,function(e,r){!e&&/^(?:IRI|blank|literal|langcode|typeIRI|\.|eof)$/.test(r.type)?t&&t(e,r):t&&t(e||i._syntaxError(r.type,t=null))})}}this._n3Mode=!1!==e.n3,this._comments=!!e.comments}var i=String.fromCharCode,r="function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},s=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,n={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},a=/[\x00-\x20<>\\"\{\}\|\^\`]/;t.prototype={_iri:/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,_unescapedString:/^"[^"\\\r\n]+"/,_singleQuotedString:/^"(?:[^"\\\r\n]|\\.)*"(?=[^"])|^'(?:[^'\\\r\n]|\\.)*'(?=[^'])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,_variable:/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/i,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_comment:/#([^\n\r]*)/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(e,t){function i(t){e(t._syntaxError(/^\S*/.exec(r)[0]))}for(var r=this._input,s=this._comments;;){for(var n,u;n=this._newline.exec(r);)s&&(u=this._comment.exec(n[0]))&&e(null,{line:this._line,type:"comment",value:u[1],prefix:""}),r=r.substr(n[0].length,r.length),this._line++;if((n=this._whitespace.exec(r))&&(r=r.substr(n[0].length,r.length)),this._endOfFile.test(r))return t&&(s&&(u=this._comment.exec(r))&&e(null,{line:this._line,type:"comment",value:u[1],prefix:""}),e(r=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=r;var c,h=this._line,f="",o="",_="",d=r[0],l=null,p=0,b=!1;switch(d){case"^":if(r.length<3)break;if("^"!==r[1]){this._n3Mode&&(p=1,f="^");break}if(this._previousMarker="^^","<"!==(r=r.substr(2))[0]){b=!0;break}case"<":if(l=this._unescapedIri.exec(r))f="IRI",o=l[1];else if(l=this._iri.exec(r)){if(null===(c=this._unescape(l[1]))||a.test(c))return i(this);f="IRI",o=c}else this._n3Mode&&r.length>1&&"="===r[1]&&(f="inverse",p=2,o="http://www.w3.org/2000/10/swap/log#implies");break;case"_":((l=this._blank.exec(r))||t&&(l=this._blank.exec(r+" ")))&&(f="blank",_="_",o=l[1]);break;case'"':case"'":if(l=this._unescapedString.exec(r))f="literal",o=l[0];else if(l=this._singleQuotedString.exec(r)){if(null===(c=this._unescape(l[0])))return i(this);f="literal",o=c.replace(/^'|'$/g,'"')}else if(l=this._tripleQuotedString.exec(r)){if(c=l[1]||l[2],this._line+=c.split(/\r\n|\r|\n/).length-1,null===(c=this._unescape(c)))return i(this);f="literal",o=c.replace(/^'|'$/g,'"')}break;case"?":this._n3Mode&&(l=this._variable.exec(r))&&(f="var",o=l[0]);break;case"@":"literal"===this._previousMarker&&(l=this._langcode.exec(r))?(f="langcode",o=l[1]):(l=this._keyword.exec(r))&&(f=l[0]);break;case".":if(1===r.length?t:r[1]<"0"||r[1]>"9"){f=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(l=this._number.exec(r)||t&&(l=this._number.exec(r+" ")))&&(f="literal",o='"'+l[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(l[1]?"double":/^[+\-]?\d+$/.test(l[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(l=this._sparqlKeyword.exec(r))?f=l[0].toUpperCase():b=!0;break;case"f":case"t":(l=this._boolean.exec(r))?(f="literal",o='"'+l[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):b=!0;break;case"a":(l=this._shortPredicates.exec(r))?(f="abbreviation",o="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):b=!0;break;case"=":this._n3Mode&&r.length>1&&(f="abbreviation",">"!==r[1]?(p=1,o="http://www.w3.org/2002/07/owl#sameAs"):(p=2,o="http://www.w3.org/2000/10/swap/log#implies"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":p=1,f=d;break;default:b=!0}if(b&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(l=this._prefix.exec(r))?((l=this._prefixed.exec(r))||t&&(l=this._prefixed.exec(r+" ")))&&(f="prefixed",_=l[1]||"",o=this._unescape(l[2])):(f="prefix",o=l[1]||"")),"^^"===this._previousMarker)switch(f){case"prefixed":f="type";break;case"IRI":f="typeIRI";break;default:f=""}if(!f)return t||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?i(this):this._input=r;var x={line:h,type:f,value:o,prefix:_};e(null,x),this.previousToken=x,this._previousMarker=f,r=r.substr(p||l[0].length,r.length)}},_unescape:function(e){try{return e.replace(s,function(e,t,r,s){var a;if(t){if(a=parseInt(t,16),isNaN(a))throw new Error;return i(a)}if(r){if(a=parseInt(r,16),isNaN(a))throw new Error;return a<=65535?i(a):i(55296+(a-=65536)/1024,56320+(1023&a))}var u=n[s];if(!u)throw new Error;return u})}catch(e){return null}},_syntaxError:function(e){this._input=null;var t=new Error('Unexpected "'+e+'" on line '+this._line+".");return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t},tokenize:function(e,t){var i=this;if(this._line=1,"string"==typeof e){if(this._input=e,"function"!=typeof t){var s,n=[];if(this._tokenizeToEnd(function(e,t){e?s=e:n.push(t)},!0),s)throw s;return n}r(function(){i._tokenizeToEnd(t,!0)})}else this._input="","function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",function(e){null!==i._input&&(i._input+=e,i._tokenizeToEnd(t,!1))}),e.on("end",function(){null!==i._input&&i._tokenizeToEnd(t,!0)}),e.on("error",t)}},e.Lexer=t}(),function(){function t(e){if(!(this instanceof t))return new t(e);this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var s="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",n="turtle"===s,a="trig"===s,u=/triple/.test(s),c=/quad/.test(s),h=this._n3Mode=/n3/.test(s),f=u||c;(this._supportsNamedGraphs=!(n||h))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||a||u||h),f&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=i,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new r({lineMode:f,n3:h}),this._explicitQuantifiers=!!e.explicitQuantifiers}function i(){}var r=e.Lexer,s="http://www.w3.org/1999/02/22-rdf-syntax-ns#",n=s+"nil",a=s+"first",u=s+"rest",c=/^[a-z][a-z0-9+.-]*:/i,h=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,f=/(?:^|\/)\.\.?(?:$|[\/#?])/,o=0,_=0;t._resetBlankNodeIds=function(){o=_=0},t.prototype={_setBase:function(e){if(e){var t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(h),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base=null},_saveContext:function(e,t,i,r,s){var n=this._n3Mode;this._contextStack.push({subject:i,predicate:r,object:s,graph:t,type:e,inverse:!!n&&this._inversePredicate,blankPrefix:n?this._prefixes._:"",quantified:n?this._quantified:null}),n&&(this._inversePredicate=!1,this._prefixes._=this._graph+".",this._quantified=Object.create(this._quantified))},_restoreContext:function(){var e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readEntity:function(e,t){var i;switch(e.type){case"IRI":case"typeIRI":i=null===this._base||c.test(e.value)?e.value:this._resolveIRI(e);break;case"type":case"blank":case"prefixed":var r=this._prefixes[e.prefix];if(void 0===r)return this._error('Undefined prefix "'+e.prefix+':"',e);i=r+e.value;break;case"var":return e.value;default:return this._error("Expected entity but got "+e.type,e)}return!t&&this._n3Mode&&i in this._quantified&&(i=this._quantified[i]),i},_readSubject:function(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject="_:b"+_++,null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,n,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph="_:b"+_++,null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forSome",this._quantifiedPrefix="_:b",this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forAll",this._quantifiedPrefix="?b-",this._readQuantifierList):this._error('Unexpected "@forAll"',e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject},_readObject:function(e){switch(e.type){case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject="_:b"+_++),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,n),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph="_:b"+_++),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph);var t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()},_readPredicateAfterBlank:function(e){return"."!==e.type||this._contextStack.length?this._readPredicate(e):(this._subject=null,this._readPunctuation(e))},_readListItem:function(e){var t=null,i=null,r=this._subject,s=this._contextStack,c=s[s.length-1],h=this._readListItem,f=!0;switch(e.type){case"[":this._saveContext("blank",this._graph,i="_:b"+_++,a,this._subject=t="_:b"+_++),h=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,i="_:b"+_++,a,n),this._subject=null;break;case")":if(this._restoreContext(),0!==s.length&&"list"===s[s.length-1].type&&this._triple(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(h=this._readPredicate,this._subject===n)return h}else if(h=this._getContextEndReader(),this._object===n)return h;i=n;break;case"literal":t=e.value,f=!1,h=this._readListItemDataTypeOrLang;break;default:if(void 0===(t=this._readEntity(e)))return}if(null===i&&(this._subject=i="_:b"+_++),null===r?null===c.predicate?c.subject=i:c.object=i:this._triple(r,u,i,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,i,a,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);f?this._triple(i,a,t,this._graph):this._object=t}return h},_readDataTypeOrLang:function(e){return this._completeLiteral(e,!1)},_readListItemDataTypeOrLang:function(e){return this._completeLiteral(e,!0)},_completeLiteral:function(e,t){var i=!1;switch(e.type){case"type":case"typeIRI":i=!0,this._object+="^^"+this._readEntity(e);break;case"langcode":i=!0,this._object+="@"+e.value.toLowerCase()}return t&&this._triple(this._subject,a,this._object,this._graph),i?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(e))},_readFormulaTail:function(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())},_readPunctuation:function(e){var t,i=this._subject,r=this._graph,s=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,s&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error('Expected punctuation to follow "'+this._object+'"',e)}if(null!==i){var n=this._predicate,a=this._object;s?this._triple(a,n,i,r):this._triple(i,n,a,r)}return t},_readBlankNodePunctuation:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._triple(this._subject,this._predicate,this._object,this._graph),t},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){if("IRI"!==e.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',e);var t=this._readEntity(e);return this._prefixes[this._prefix]=t,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation},_readBaseIRI:function(e){return"IRI"!==e.type?this._error("Expected IRI to follow base declaration",e):(this._setBase(null===this._base||c.test(e.value)?e.value:this._resolveIRI(e)),this._readDeclarationPunctuation)},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+_++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_readQuantifierList:function(e){var t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error("Unexpected "+e.type,e)}return this._explicitQuantifiers?(null===this._subject?this._triple(this._graph||"",this._predicate,this._subject="_:b"+_++,"urn:n3:quantifiers"):this._triple(this._subject,u,this._subject="_:b"+_++,"urn:n3:quantifiers"),this._triple(this._subject,a,t,"urn:n3:quantifiers")):this._quantified[t]=this._quantifiedPrefix+_++,this._readQuantifierPunctuation},_readQuantifierPunctuation:function(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._triple(this._subject,u,n,"urn:n3:quantifiers"),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))},_getPathReader:function(e){return this._afterPath=e,this._readPath},_readPath:function(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:var t=this._contextStack,i=t.length&&t[t.length-1];if(i&&"item"===i.type){var r=this._subject;this._restoreContext(),this._triple(this._subject,a,r,this._graph)}return this._afterPath(e)}},_readForwardPath:function(e){var t,i,r="_:b"+_++;if(void 0!==(i=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=r):(t=this._object,this._object=r),this._triple(t,i,r,this._graph),this._readPath},_readBackwardPath:function(e){var t,i,r="_:b"+_++;if(void 0!==(t=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=r):(i=this._object,this._object=r),this._triple(r,t,i,this._graph),this._readPath},_getContextEndReader:function(){var e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail}},_triple:function(e,t,i,r){this._callback(null,{subject:e,predicate:t,object:i,graph:r||""})},_error:function(e,t){var i=new Error(e+" on line "+t.line+".");i.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(i)},_resolveIRI:function(e){var t=e.value;switch(t[0]){case void 0:return this._base;case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return this._removeDotSegments(this._basePath+t)}},_removeDotSegments:function(e){if(!f.test(e))return e;for(var t="",i=e.length,r=-1,s=-1,n=0,a="/";r<i;){switch(a){case":":if(s<0&&"/"===e[++r]&&"/"===e[++r])for(;(s=r+1)<i&&"/"!==e[s];)r=s;break;case"?":case"#":r=i;break;case"/":if("."===e[r+1])switch(a=e[++r+1]){case"/":t+=e.substring(n,r-1),n=r+1;break;case void 0:case"?":case"#":return t+e.substring(n,r)+e.substr(r+1);case".":if(void 0===(a=e[++r+1])||"/"===a||"?"===a||"#"===a){if(t+=e.substring(n,r-2),(n=t.lastIndexOf("/"))>=s&&(t=t.substr(0,n)),"/"!==a)return t+"/"+e.substr(r+1);n=r+1}}}a=e[++r]}return t+e.substring(n)},parse:function(e,t,r){var s=this;if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+o+++"_",this._prefixCallback=r||i,this._inversePredicate=!1,this._quantified=Object.create(null),!t){var n,a=[];if(this._callback=function(e,t){e?n=e:t&&a.push(t)},this._lexer.tokenize(e).every(function(e){return s._readCallback=s._readCallback(e)}),n)throw n;return a}this._callback=t,this._lexer.tokenize(e,function(e,t){null!==e?(s._callback(e),s._callback=i):s._readCallback&&(s._readCallback=s._readCallback(t))})}},e.Parser=t}(),function(){function t(e,i){if(!(this instanceof t))return new t(e,i);if(e&&"function"!=typeof e.write&&(i=e,e=null),i=i||{},e)this._outputStream=e,this._endStream=void 0===i.end||!!i.end;else{var r="";this._outputStream={write:function(e,t,i){r+=e,i&&i()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(i.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),i.prefixes&&this.addPrefixes(i.prefixes))}function i(e){var t=a[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}var r=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,s=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,n=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,a={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};t.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,i,r,s){try{this._graph!==r&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(r?this._encodeIriOrBlankNode(r)+" {\n":"")),this._subject=null,this._graph="["!==r[0]?r:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(i),s):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),s):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),s)}catch(e){s&&s(e)}},_writeTripleLine:function(e,t,i,r,s){delete this._prefixMatch;try{this._write(this.tripleToString(e,t,i,r),s)}catch(e){s&&s(e)}},tripleToString:function(e,t,i,r){return this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(i)+(r?" "+this._encodeIriOrBlankNode(r)+".\n":".\n")},triplesToString:function(e){return e.map(function(e){return this.tripleToString(e.subject,e.predicate,e.object,e.graph)},this).join("")},_encodeIriOrBlankNode:function(e){var t=e[0];if("["===t||"("===t||"_"===t&&":"===e[1])return e;s.test(e)&&(e=e.replace(n,i));var r=this._prefixRegex.exec(e);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:e:"<"+e+">"},_encodeLiteral:function(e,t,r){return s.test(e)&&(e=e.replace(n,i)),r?'"'+e+'"@'+r:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=r.exec(e);if(!t)throw new Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,i,r,s){void 0===i?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof r?this._writeTriple(e,t,i,"",r):this._writeTriple(e,t,i,r,s)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,i){var r={};r[e]=t,this.addPrefixes(r,i)},addPrefixes:function(e,t){var i=this._prefixIRIs,r=!1;for(var s in e){var n=e[s];/[#\/]$/.test(n)&&i[n]!==(s+=":")&&(r=!0,i[n]=s,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+s+" <"+n+">.\n"))}if(r){var a="",u="";for(var c in i)a+=a?"|"+c:c,u+=(u?"|":"")+i[c];a=a.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+u+")[^/]*$|^("+a+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(r?"\n":"",t)},blank:function(e,t){var i,r,s=e;switch(void 0===e?s=[]:"string"==typeof e?s=[{predicate:e,object:t}]:"length"in e||(s=[e]),r=s.length){case 0:return"[]";case 1:if("["!==(i=s[0]).object[0])return"[ "+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object)+" ]";default:for(var n="[",a=0;a<r;a++)(i=s[a]).predicate===e?n+=", "+this._encodeObject(i.object):(n+=(a?";\n  ":"\n  ")+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object),e=i.predicate);return n+"\n]"}},list:function(e){for(var t=e&&e.length||0,i=new Array(t),r=0;r<t;r++)i[r]=this._encodeObject(e[r]);return"("+i.join(" ")+")"},_prefixRegex:/$0^/,end:function(e){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(i,r){t=null,e(i,r)};if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}},e.Writer=t}(),function(){function t(e,i){if(!(this instanceof t))return new t(e,i);this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,i||!e||e[0]||(i=e,e=null),i=i||{},this._prefixes=Object.create(null),i.prefixes&&this.addPrefixes(i.prefixes),e&&this.addTriples(e)}function i(e){return"string"==typeof e||e instanceof String}var r=e.Util.expandPrefixedName;t.prototype={get size(){var e=this._size;if(null!==e)return e;e=0;var t,i,r=this._graphs;for(var s in r)for(var n in t=r[s].subjects)for(var a in i=t[n])e+=Object.keys(i[a]).length;return this._size=e},_addToIndex:function(e,t,i,r){var s=e[t]||(e[t]={}),n=s[i]||(s[i]={}),a=r in n;return a||(n[r]=null),!a},_removeFromIndex:function(e,t,i,r){var s,n=e[t],a=n[i];delete a[r];for(s in a)return;delete n[i];for(s in n)return;delete e[t]},_findInIndex:function(e,t,i,r,s,n,a,u,c,h){var f,o,_,d=!t+!i+!r>1?Object.keys(this._ids):this._entities;t&&((f=e,e={})[t]=f[t]);for(var l in e){var p=d[l];if(o=e[l]){i&&((f=o,o={})[i]=f[i]);for(var b in o){var x=d[b];if(_=o[b])for(var g=(r?r in _?[r]:[]:Object.keys(_)),v=g.length-1;v>=0;v--){var I={subject:"",predicate:"",object:"",graph:u};if(I[s]=p,I[n]=x,I[a]=d[g[v]],h)h.push(I);else if(c(I))return!0}}}}return h},_loop:function(e,t){for(var i in e)t(i)},_loopByKey0:function(e,t,i){var r,s;if(r=e[t])for(s in r)i(s)},_loopByKey1:function(e,t,i){var r;for(r in e)e[r][t]&&i(r)},_loopBy2Keys:function(e,t,i,r){var s,n,a;if((s=e[t])&&(n=s[i]))for(a in n)r(a)},_countInIndex:function(e,t,i,r){var s,n,a,u=0;t&&((s=e,e={})[t]=s[t]);for(var c in e)if(n=e[c]){i&&((s=n,n={})[i]=s[i]);for(var h in n)(a=n[h])&&(r?r in a&&u++:u+=Object.keys(a).length)}return u},_getGraphs:function(e){if(!i(e))return this._graphs;var t={};return t[e]=this._graphs[e],t},_uniqueEntities:function(e){var t=Object.create(null),i=this._entities;return function(r){r in t||(t[r]=!0,e(i[r]))}},addTriple:function(e,t,i,r){t||(r=e.graph,i=e.object,t=e.predicate,e=e.subject),r=r||"";var s=this._graphs[r];s||(s=this._graphs[r]={subjects:{},predicates:{},objects:{}},Object.freeze(s));var n=this._ids,a=this._entities;e=n[e]||(n[a[++this._id]=e]=this._id),t=n[t]||(n[a[++this._id]=t]=this._id),i=n[i]||(n[a[++this._id]=i]=this._id);var u=this._addToIndex(s.subjects,e,t,i);return this._addToIndex(s.predicates,t,i,e),this._addToIndex(s.objects,i,e,t),this._size=null,u},addTriples:function(e){for(var t=e.length-1;t>=0;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,i,r){t||(r=e.graph,i=e.object,t=e.predicate,e=e.subject),r=r||"";var s,n,a,u=this._ids,c=this._graphs;if(!((e=u[e])&&(t=u[t])&&(i=u[i])&&(s=c[r])&&(n=s.subjects[e])&&(a=n[t])&&i in a))return!1;this._removeFromIndex(s.subjects,e,t,i),this._removeFromIndex(s.predicates,t,i,e),this._removeFromIndex(s.objects,i,e,t),null!==this._size&&this._size--;for(e in s.subjects)return!0;return delete c[r],!0},removeTriples:function(e){for(var t=e.length-1;t>=0;t--)this.removeTriple(e[t])},getTriples:function(e,t,i,s){var n=this._prefixes;return this.getTriplesByIRI(r(e,n),r(t,n),r(i,n),r(s,n))},getTriplesByIRI:function(e,t,r,s){var n,a,u,c,h=[],f=this._getGraphs(s),o=this._ids;if(i(e)&&!(a=o[e])||i(t)&&!(u=o[t])||i(r)&&!(c=o[r]))return h;for(var _ in f)(n=f[_])&&(a?c?this._findInIndex(n.objects,c,a,u,"object","subject","predicate",_,null,h):this._findInIndex(n.subjects,a,u,null,"subject","predicate","object",_,null,h):u?this._findInIndex(n.predicates,u,c,null,"predicate","object","subject",_,null,h):c?this._findInIndex(n.objects,c,null,null,"object","subject","predicate",_,null,h):this._findInIndex(n.subjects,null,null,null,"subject","predicate","object",_,null,h));return h},countTriples:function(e,t,i,s){var n=this._prefixes;return this.countTriplesByIRI(r(e,n),r(t,n),r(i,n),r(s,n))},countTriplesByIRI:function(e,t,r,s){var n,a,u,c,h=0,f=this._getGraphs(s),o=this._ids;if(i(e)&&!(a=o[e])||i(t)&&!(u=o[t])||i(r)&&!(c=o[r]))return 0;for(var _ in f)(n=f[_])&&(h+=e?r?this._countInIndex(n.objects,c,a,u):this._countInIndex(n.subjects,a,u,c):t?this._countInIndex(n.predicates,u,c,a):this._countInIndex(n.objects,c,a,u));return h},forEach:function(e,t,i,s,n){var a=this._prefixes;this.forEachByIRI(e,r(t,a),r(i,a),r(s,a),r(n,a))},forEachByIRI:function(e,t,i,r,s){this.someByIRI(function(t){return e(t),!1},t,i,r,s)},every:function(e,t,i,s,n){var a=this._prefixes;return this.everyByIRI(e,r(t,a),r(i,a),r(s,a),r(n,a))},everyByIRI:function(e,t,i,r,s){var n=!1,a=!this.someByIRI(function(t){return n=!0,!e(t)},t,i,r,s);return n&&a},some:function(e,t,i,s,n){var a=this._prefixes;return this.someByIRI(e,r(t,a),r(i,a),r(s,a),r(n,a))},someByIRI:function(e,t,r,s,n){var a,u,c,h,f=this._getGraphs(n),o=this._ids;if(i(t)&&!(u=o[t])||i(r)&&!(c=o[r])||i(s)&&!(h=o[s]))return!1;for(var _ in f)if(a=f[_])if(u){if(h){if(this._findInIndex(a.objects,h,u,c,"object","subject","predicate",_,e,null))return!0}else if(this._findInIndex(a.subjects,u,c,null,"subject","predicate","object",_,e,null))return!0}else if(c){if(this._findInIndex(a.predicates,c,h,null,"predicate","object","subject",_,e,null))return!0}else if(h){if(this._findInIndex(a.objects,h,null,null,"object","subject","predicate",_,e,null))return!0}else if(this._findInIndex(a.subjects,null,null,null,"subject","predicate","object",_,e,null))return!0;return!1},getSubjects:function(e,t,i){var s=this._prefixes;return this.getSubjectsByIRI(r(e,s),r(t,s),r(i,s))},getSubjectsByIRI:function(e,t,i){var r=[];return this.forSubjectsByIRI(function(e){r.push(e)},e,t,i),r},forSubjects:function(e,t,i,s){var n=this._prefixes;this.forSubjectsByIRI(e,r(t,n),r(i,n),r(s,n))},forSubjectsByIRI:function(e,t,r,s){var n,a,u,c=this._ids,h=this._getGraphs(s);if(e=this._uniqueEntities(e),!(i(t)&&!(a=c[t])||i(r)&&!(u=c[r])))for(s in h)(n=h[s])&&(a?u?this._loopBy2Keys(n.predicates,a,u,e):this._loopByKey1(n.subjects,a,e):u?this._loopByKey0(n.objects,u,e):this._loop(n.subjects,e))},getPredicates:function(e,t,i){var s=this._prefixes;return this.getPredicatesByIRI(r(e,s),r(t,s),r(i,s))},getPredicatesByIRI:function(e,t,i){var r=[];return this.forPredicatesByIRI(function(e){r.push(e)},e,t,i),r},forPredicates:function(e,t,i,s){var n=this._prefixes;this.forPredicatesByIRI(e,r(t,n),r(i,n),r(s,n))},forPredicatesByIRI:function(e,t,r,s){var n,a,u,c=this._ids,h=this._getGraphs(s);if(e=this._uniqueEntities(e),!(i(t)&&!(a=c[t])||i(r)&&!(u=c[r])))for(s in h)(n=h[s])&&(a?u?this._loopBy2Keys(n.objects,u,a,e):this._loopByKey0(n.subjects,a,e):u?this._loopByKey1(n.predicates,u,e):this._loop(n.predicates,e))},getObjects:function(e,t,i){var s=this._prefixes;return this.getObjectsByIRI(r(e,s),r(t,s),r(i,s))},getObjectsByIRI:function(e,t,i){var r=[];return this.forObjectsByIRI(function(e){r.push(e)},e,t,i),r},forObjects:function(e,t,i,s){var n=this._prefixes;this.forObjectsByIRI(e,r(t,n),r(i,n),r(s,n))},forObjectsByIRI:function(e,t,r,s){var n,a,u,c=this._ids,h=this._getGraphs(s);if(e=this._uniqueEntities(e),!(i(t)&&!(a=c[t])||i(r)&&!(u=c[r])))for(s in h)(n=h[s])&&(a?u?this._loopBy2Keys(n.subjects,a,u,e):this._loopByKey1(n.objects,a,e):u?this._loopByKey0(n.predicates,u,e):this._loop(n.objects,e))},getGraphs:function(e,t,i){var s=this._prefixes;return this.getGraphsByIRI(r(e,s),r(t,s),r(i,s))},getGraphsByIRI:function(e,t,i){var r=[];return this.forGraphsByIRI(function(e){r.push(e)},e,t,i),r},forGraphs:function(e,t,i,s){var n=this._prefixes;this.forGraphsByIRI(e,r(t,n),r(i,n),r(s,n))},forGraphsByIRI:function(e,t,i,r){for(var s in this._graphs)this.someByIRI(function(t){return e(t.graph),!0},t,i,r,s)},createBlankNode:function(e){var t,i;if(e)for(t=e="_:"+e,i=1;this._ids[t];)t=e+i++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,t}},e.Store=t}()}("undefined"!=typeof exports?exports:this.N3={});